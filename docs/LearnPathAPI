openapi: 3.0.3
info: 
  title: LearnPath API
  version: '1.0.0'
  description: |
    The LearnPath API helps you learn a given topic faster and more organized.

    ### Current Features:
      * Generate a roadmap on different milestones to master for learning the given topic
      * Personalized roadmap based on User's level
      * ... IDK

  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0

servers:
  - url: http://localhost:8000
    description: Local development
  - url: https://api.learnpath.com
    description: Production server

paths:
  /api/users:
      get:
        summary: Retrieve a list of users
        responses:           
          '200':               
            description: List retrieved
            content:      
              application/json:     #JSON response
                schema:      #Structure of the response
                  type: array
                  items:          # Each item in the array is
                    type: object
                    properties:
                      id:
                        type: integer
                      name:
                        type: string
                      email:
                        type: string
          '401':
            description: Invalid credentials
          '404':
            description: Not found
          '500':
            description: Server error
      post:  
        summary: Create a new user
        requestBody:  #Request Parameters that user need to send to API
          required: true
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: string
                  email:
                    type: string
                  password:
                    type: string
        responses:
          '201':
            description: User created successfully
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    success: 
                      type: boolean
                    user: 
                      type: object
                    properties:
                      id:
                        type: integer
                      name: 
                        type: string
                      email: 
                        type: string
          '400':
            description: Bad request
  /api/users/{id}:
    put:  
      summary: Update user information
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer 
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                email:
                  type: string
      responses:
        '200':
          description: User updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '404':
          description: User not found
    delete:  
      summary: Delete a user
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: User deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '404':
          description: User not found
  /api/auth/login:
    post:
      summary: sign in with user info
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties: 
                email:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: Login in successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  token: 
                    type: string
                  user:
                    description: return user object to frontend so no extra API call needed
                    type: object
                    properties:
                      id:
                        type: integer
                      name: 
                        type: string
                      email:
                        type: string
        '400':
          description: Bad request
        '401':
          description: Wrong Username/Password
  /api/auth/logout:
    post:
      summary: logout of the account
      security:
        - bearerAuth: []
      responses:
        '200':
          description: logout successfully
        '500': 
          description: server internal error
  /api/learningpaths:
    post:
      description: user enters what they wanna learn, proficiency on the topic already*, type of learning*, weeks that they wanna learn it in 
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                topic:
                  type: object
                  properties:
                    name:
                      type: string
                    difficulty:
                      type: string
      responses:
        '201':
          description: LearningPath successfully created
        '500':
          description: Internal server error
    get:
      description: gets and shows all the learning paths that the user is working on (planning to implement groq that will take on this info and make the weekly plans based off of it)
      responses:
        '200':
          description: get all the learningPath the user currently working on
          content:
            application/json:
              schema:
                type: object
                properties:
                  learningPath: 
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                        topic: 
                          type: string
        '401':
          description: token expired
        '500':
          description: internal server issues
  /api/learningpaths/{id}:
    get:
      summary: get a specific learning path using id
      description: returns progress about learning path
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Learning path retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  topic:
                    type: string
                  difficulty:
                    type: string
                  weeks_to_complete:
                    type: integer
                  current_step:
                    type: integer
                  completed_steps:
                    type: integer
                  estimated_mastery_date:
                    type: string
                    format: date
        '401':
          description: Unauthorized
        '404':
          description: Learning path not found
        '500':
          description: Server error

    put:
      summary: update/put the learning path
      description: update proficiency level and learning type
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                proficiency:
                  type: string
                  enum: [beginner, intermediate, advanced]
                learning_type:
                  type: string
                weeks_to_complete:
                  type: integer
      responses:
        '401':
          description: Unauthorized
        '404':
          description: Learning path not found
        '500':
          description: Server error

    delete:
      summary: delete learning path
      description: removes the learning path permanently.
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Learning path deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '401':
          description: Unauthorized
        '404':
          description: Learning path not found
        '500':
          description: Server error
  /api/learningpaths/{id}/weeklyplan:
    get:
      summary: get weekly plans for learning path
      description: returns all weekly milestones and progress
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID of the learning path
      responses:
        '200':
          description: Weekly plans retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  learning_path_id:
                    type: integer
                  weeks:
                    type: array
                    items:
                      type: object
                      properties:
                        week_id:
                          type: integer
                        week_number:
                          type: integer
                        goal:
                          type: string
                        completed:
                          type: boolean
        '401':
          description: Unauthorized
        '404':
          description: Learning path not found
        '500':
          description: Server error  
          
#Data models(components)
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    oauth2Auth:
      type: oauth2
      flows:
       password:
         tokenUrl: /api/auth/login
         scopes:
          read: read access
          write: write access
          admin: admin access  
  schemas:
    User:
      type: object
      description: Represents a user account
      required:
        - id
        - name
        - email
        - password
        - experience_level
        - created_at
      properties:
        id:
          type: integer
          description: Unique identifier for each user
          readOnly: true
        name:
          type: string
          description: User's first name and last name initial
        email:
          type: string
          format: email
          description: User's email, must be unique and correct format
        password:
          type: string
          description: User's password (hashed)
          minLength: 8
          maxLength: 20
          writeOnly: true
        experience_level:
          type: string
          description: User's proficiency
          enum:
            - beginner
            - intermediate
            - advanced
        created_at:
          type: string
          format: date-time
          description: Time the user was created
          readOnly: true
    LearningPath:
      type: object
      description: Visualization of topics to master
      required:
        - id
        - user_id
        - topic_name
        - weeks
      properties:
        id:
          type: integer
          description: ID corresponding to generated learning path
          readOnly: true
        user_id:
          type: integer
          description: Foreign key that refers to the user_id
        topic_name:
          type: string
          description: Topic the user wants to learn e.g. Python, Data Structures
          maxLength: 30
        topic_category:
          type: string
          description: Category of the topic e.g. programming, data structures
        difficulty:
          type: string
          description: User's proficiency level for this topic
          enum:
            - beginner
            - intermediate
            - advanced
        learning_type:
          type: array
          items:
            type: string
            enum:
              - videos
              - websites
              - visuals
              - audio
              - articles
              - tutorials
              - exercises
        weeks:
          type: integer
          minimum: 1
          maximum: 52
        current_step:
          type: integer
          description: Where the user is currently on the learning path
        completed_steps:
          type: integer
          description: How many steps the user has completed
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
    WeeklyPlan:
      type: object
      description: Plans for each week to complete learningPath
      required:
        - week_number
        - goal
        - completion_status
      properties:
        id:
          type: integer
          readOnly: true
        learning_path_id:
          type: integer
          description: Foreign key that refers to the learning path primary key
        week_number:
          type: integer
          minimum: 1
          maximum: 52
        goal:
          type: array
          description: Short description of personal goal(s) on what to achieve
          minItems: 1
          maxItems: 3
          items:
            type: string
            maxLength: 100
        completion_status:
          type: boolean
          readOnly: true
        plan_description:
          type: string
          maxLength: 1000
    Resources:
      type: object
      description: AI generated resources relating to provided topic
      required:
        - resource_type
        - url
        - resource_summary
      properties:
        id:
          type: integer
          readOnly: true
        weekly_plan_id:
          type: integer
          description: Foreign key that refers to the weekly plan primary key
        resource_type:
          type: string
          description: Has to be an option from the listed learning_type
        resource_summary:
          type: string
          description: Summarize what the provided resource is about
          maxLength: 300
        url:
          type: string
          description: Link to the resource
          maxLength: 2000
