openapi: 3.0.3
info: 
  title: LearnPath API
  version: '1.0.0'
  description: |
    The LearnPath API helps you learn a given topic faster and more organized.

    ### Current Features:
      * Generate a roadmap on different milestones to master for learning the given topic
      * Personalized roadmap based on User's level
      * ... IDK

  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0

servers:
  - url: http://localhost:8000
    description: Local development
  - url: https://api.learnpath.com
    description: Production server

paths:
  /api/users:
      get:
        summary: Retrieve a list of users
        responses:           
          '200':               
            description: List retrieved
            content:      
              application/json:     #JSON response
                schema:      #Structure of the response
                  type: array
                  items:          # Each item in the array is
                    type: object
                    properties:
                      id:
                        type: integer
                      name:
                        type: string
                      email:
                        type: string
          '401':
            description: Invalid credentials
          '404':
            description: Not found
          '500':
            description: Server error
      post:  
        summary: Create a new user
        requestBody:  #Request Parameters that user need to send to API
          required: true
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: string
                  email:
                    type: string
                  password:
                    type: string
        responses:
          '201':
            description: User created successfully
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    success: 
                      type: boolean
                    user: 
                      type: object
                    properties:
                      id:
                        type: integer
                      name: 
                        type: string
                      email: 
                        type: string
          '400':
            description: Bad request
  /api/users/{id}:
    put:  
      summary: Update user information
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer 
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                email:
                  type: string
      responses:
        '200':
          description: User updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '404':
          description: User not found
    delete:  
      summary: Delete a user
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: User deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '404':
          description: User not found
  /api/auth/login:
    post:
      summary: sign in with user info
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties: 
                email:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: Login in successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  token: 
                    type: string
                  user:
                    description: return user object to frontend so no extra API call needed
                    type: object
                    properties:
                      id:
                        type: integer
                      name: 
                        type: string
                      email:
                        type: string
        '400':
          description: Bad request
        '401':
          description: Wrong Username/Password
  /api/auth/logout:
    post:
      summary: logout of the account
      security:
        - bearerAuth: []
      responses:
        '200':
          description: logout successfully
        '500': 
          description: server internal error
  /api/learningpaths:
    post:
      description: user enters what they wanna learn, proficiency on the topic already*, type of learning*, weeks that they wanna learn it in 
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                topic:
                  type: object
                  properties:
                    name:
                      type: string
                    difficulty:
                      type: string
      responses:
        '201':
          description: LearningPath successfully created
        '500':
          description: Internal server error
    get:
      description: gets and shows all the learning paths that the user is working on (planning to implement groq that will take on this info and make the weekly plans based off of it)
      responses:
        '200':
          description: get all the learningPath the user currently working on
          content:
            application/json:
              schema:
                type: object
                properties:
                  learningPath: 
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                        topic: 
                          type: string
        '401':
          description: token expired
        '500':
          description: internal server issues
  /api/learningpaths/{id}:
    get:
      summary: get a specific learning path using id
      description: returns progress about learning path
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Learning path retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  topic:
                    type: string
                  difficulty:
                    type: string
                  weeks_to_complete:
                    type: integer
                  current_step:
                    type: integer
                  completed_steps:
                    type: integer
                  estimated_mastery_date:
                    type: string
                    format: date
        '401':
          description: Unauthorized
        '404':
          description: Learning path not found
        '500':
          description: Server error

    put:
      summary: update/put the learning path
      description: update proficiency level and learning type
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                proficiency:
                  type: string
                  enum: [beginner, intermediate, advanced]
                learning_type:
                  type: string
                weeks_to_complete:
                  type: integer
      responses:
        '401':
          description: Unauthorized
        '404':
          description: Learning path not found
        '500':
          description: Server error

    delete:
      summary: delete learning path
      description: removes the learning path permanently.
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Learning path deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
        '401':
          description: Unauthorized
        '404':
          description: Learning path not found
        '500':
          description: Server error
  /api/learningpaths/{id}/weeklyplan:
    get:
      summary: get weekly plans for learning path
      description: returns all weekly milestones and progress
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: ID of the learning path
      responses:
        '200':
          description: Weekly plans retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  learning_path_id:
                    type: integer
                  weeks:
                    type: array
                    items:
                      type: object
                      properties:
                        week_id:
                          type: integer
                        week_number:
                          type: integer
                        goal:
                          type: string
                        completed:
                          type: boolean
        '401':
          description: Unauthorized
        '404':
          description: Learning path not found
        '500':
          description: Server error  
          
#Data models(components)
components:
  schemas:
    securitySchemes:
      bearerAuth:
        type: http             # It's HTTP-based authentication
        scheme: bearer         # Uses "bearer" token
        bearerFormat: JWT      # JWT Tokens in this case
    User:
      type: object
      description: Represents an user account
      required:
        - id
        - name
        - email
        - password
        - experience_level
        - created_at
      properties:
        id:
          type: integer
          description: Unique identifier for each user
          readOnly: true  # User can't input this
        name:
          type: string 
          description: user's first name and last name initial
        email:
          type: string
          format: email #will be implement
          description: user's email, must be unique & right format
        password:
          type: string
          description: user's password (hashed)
          minLength: 8
          maxLength: 20
          writeOnly: true # Don't return this in successful confirmation message
        experience_level:
          type: string
          description: user's proficiency
          enum:
            - beginner
            - intermediate
            - advanced
        created_at:
          type: string
          format: date-time
          description: time the user is created
          readOnly: true 
    Topic:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        name:
          type: string
          description: Topic name like python etc
        category:
          type: string
          description: like programming, data structure etc
          enum:
            - beginner
            - intermediate
            - advanced
        created_at:
          type: string
          format: date-time
          readOnly: true
    LearningPath:
      type: object
      description: visualization of topics to master 
      required:
        - id
        - User_ID
        - Current_step
        - Completed_steps
      properties:
        id: 
          type: integer
          description: id corresponding to generated learningpath
          readOnly: true
        user_ID:
          type: integer
          description: foreign key that refers to the user_ID
        complete_steps:
          type: integer
          description: how many steps have the user completed
          readOnly: true
        current_step:
          type: integer
          description: where the user is currently on the learningpath




      
